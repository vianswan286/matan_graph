ИИ - workflow для создания граяа матанализа по конспектам
Может быть использовано и для других математических дисциплин

1) Выделить определения и теоремы из каждой лекции. Собрать их в виде json файла
    В папке parsed_lections
2) В базу данных добавить все определения. При добавлении нового убедиться что нет дубликатов
    Для этого находим по топ 2 кандидата на идентичность и каждый раз спрашиваем:
        а) Мешок слов" (Bag-of-Words) с TF-IDF   - на русском виде для термина

        б) Мешок слов" (Bag-of-Words) с TF-IDF   - на русском виде для определения

        в) Мешок слов" (Bag-of-Words) с TF-IDF   - на английском языке с формулировкой чисто словами для термина

        г) Мешок слов" (Bag-of-Words) с TF-IDF   - на английском языке с формулировкой чисто словами для оперделения

        # ToDo д) Эмбеддинги                            - на английском языке с формулировкой чисто словами

    Каждый раз даем на проверку LLM

3) В базу, аналогично, добавляем все теоремы. При добавлении проверяем дубликаты:
    Для этого находим топ 2 кандидата на идентичность и каждый раз спрашиваем LLM:
        а) Мешок слов" (Bag-of-Words) с TF-IDF   - на русском языке для названия теоремы (30% веса)
        
        б) Мешок слов" (Bag-of-Words) с TF-IDF   - на русском языке для формулировки теоремы (70% веса)
        
    Каждый раз даем на проверку LLM для семантической верификации

4) Для каждой теоремы все определения и теоремы на которые она ссылается в формулировке или доказательстве - превращаем в ребро

## Реализованный функционал

### Проверка дубликатов определений
Функция `find_definition(term_ru, definition_ru, db_name='math_base.db')` в `search.py`:
- Использует TF-IDF для поиска схожих определений
- Комбинирует сходство термина (40%) и определения (60%)
- Проверяет топ-2 кандидата с similarity > 0.1
- Верифицирует семантическое соответствие через LLM (OpenRouter GPT-4)
- Возвращает ID существующего определения или None

### Проверка дубликатов теорем
Функция `find_theorem(name_ru, statement_ru, db_name='math_base.db')` в `search.py`:
- Использует TF-IDF для поиска схожих теорем
- Комбинирует сходство названия (30%) и формулировки (70%)
- Проверяет топ-2 кандидата с similarity > 0.1  
- Верифицирует семантическое соответствие через LLM (OpenRouter GPT-4)
- Возвращает ID существующей теоремы или None

### Агент обработки (agent.py)
LangGraph агент с инструментами для:
- Чтения JSON файлов из parsed_lections
- Проверки дубликатов определений и теорем
- Добавления в базу данных
- Анализа зависимостей между математическими объектами
- Создания связей в графе знаний

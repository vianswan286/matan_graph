\newpage

\section{Дифференцируемость функций многих переменных}

\subsection{Дифференцируемая функция, дифференциал, градиент}
\begin{definition}
    Пусть $G \subset \R ^n$~---~непустое открытое множество. \\ Функция $f$: $G \mapsto \R$ называется \textit{дифференцируемой в точке} $x^0 \in G$, если существует линейное отображение $A$: $\R^n \mapsto \R$  $\left( \Longleftrightarrow \exists \ \overline{A} \in \R^n = (A_{1}, \ldots, A_{n})\right) $: $\forall h \in \R^n$ с достаточно малой нормой $\hookrightarrow$

    \begin{equation}\label{eq1}\tag{$\star$}
         f(x^0 + h) = f(x^0) + A(h) + o(\|h\|), h \to 0 
    \end{equation}

    При этом само отображение $A$: $\R^n \mapsto \R$ называется \underline{\textit{дифференциалом функции}} $f$ в точке $x^0$ и обозначается $d_{x^0} f \equiv A$, а вектор $\overline{A} = \left(A_1, \ldots A_n \right)$ называется \underline{\textit{градиентом функции}} $f$ в точке $x^0$ и обозначается символом grad$f(x^0)$. \\

    $$ \eqref{eq1} \Longleftrightarrow f(x^0 + h) = f(x^0) + d_{x^0} f(h) + o(\|h\|), h \to 0 $$
    $$ \Longleftrightarrow f(x^0 + h) = f(x^0) + \langle \text{grad}f(x^0), h\rangle + o(\|h\|), h \to 0.$$
\end{definition}

\begin{definition}
    Пусть $G \subset \R^n$, $f$: $G \mapsto \R$. \\
    \textit{График функции} $f$~---~это множество в $\R^{n+1}$, graph$f := \left\{ (x, f(x)): x \in G\right\}$.
\end{definition}

$\overline{n} = (n_x, n_y, n_z)$~---~нормальный вектор поверхности, проходящий через точку $(x^0, y^0, z^0)$.

Будем считать, что плоскость <<не вертикальна>>\,, то есть $n_z \neq 0$. Тогда уравнение имеет вид $$n_x(x-x^0) + n_y(y-y^0) + n_z(z - z^0) = 0.$$
$$z = z^0 - \dfrac{n_x}{n_z}(x-x^0) - \dfrac{n_y}{n_z}(y - y^0)$$

$\Longrightarrow$ уравнение плоскости примет вид

\begin{equation}\label{eq2}\tag{$\star$}
    z = f(x^0, y^0) + N_x(x-x^0)+N_y(y-y^0).
\end{equation}

Плоскость вида \eqref{eq2} называется \textit{касательной} к графику функции $f$: $G \mapsto \R$ в точке $(x^0, y^0, f(x^0, y^0))$, если $f(x, y) = z(x, y) + o\left( \sqrt{(x-x^0)^2 + (y-y^0)^2}\right)$, $(x, y) \mapsto (x^0, y^0).$

\begin{theorem}
    \textit{(Геометрический смысл градиента и дифференциала)} \\ Пусть $G \subset \R^n$~---~непустое открытое множество, $f$: $G \mapsto \R$ и $(x^0, y^0) \in G$.
    Функция $f$ дифференцируема в точке $(x^0, y^0)$ $\Longleftrightarrow$ $\exists$ касательная плоскость к графику $f$ в точке $(x^0, y^0, f(x^0, y^0))$, при этом $\left(N_x, N_y\right) = \textup{grad}f(x^0, y^0)$, а d$f$~---~это приращение $z$ вдоль касательной плоскости, то есть
    $$\text{d}f = z(x^0 + h_1, x^0 + h_2) - z(x^0, y^0), \ h=(h_1, h_2) \in \R^2.$$
    Нормальный вектор к касательной плоскости $(\textup{grad} f(x^0, y^0), -1).$
\end{theorem}

\begin{proof}
    Дифференцируемость в точке $(x^0, y^0) \Longleftrightarrow \exists \ \overline{A} = (A_1, A_2)$:
    $$f(x, y) -  f(x^0, y^0) = A_1(x-x^0)+A_2(y-y^0)+o\left(\sqrt{\left(x-x^0\right)^2+\left(y-y^0\right)^2}\right), (x, y) \to \left(x^0, y^0\right)$$
    $$\Longleftrightarrow \exists \ N_x=A_1, N_y=A_2 \text{, такие что}$$
    $$f(x, y) - z(x, y) = o(\sqrt{\left(x-x^0\right)^2+\left(y-y^0\right)^2}), (x, y) \to \left(x^0, y^0\right) \Longleftrightarrow$$ 
    по определению $\exists$ касательная плоскость в точке $\left(x^0, y^0, f\left(x^0, y^0\right)\right)$, и при этом $\left(N_x, N_y\right) = \textup{grad}f(x^0)$. \\
    Далее по определению дифференциала получаем, что 
    $$z(x, y) - z(x^0, y^0) = d_{(x^0, y^0)}f((x-x^0, y-y^0)).$$
\end{proof}

\subsection{Необходимые условия дифференцируемости в точке}
\begin{theorem}
    Пусть $G \subset R^n$~---~непустое открытое множество и $f$: $G \mapsto \R$. Если $f$ дифференцируема в точке $x^0 \in G$, то она непрерывна в точке $x^0$.
\end{theorem}

\begin{proof}
    Если $f$ дифференцируема в точке $x^0$, то 
    $$f(x) = f(x^0) + d_{x^0}f(x-x^0) + o\left(\|x - x^0\|\right), \ x \to x^{0}.$$
    $$d_{x^0}f(x-x^0) \to 0, \ x \to x^{0}.$$
    Значит $f(x) \to f(x^0), \ x \to x^{0}.$
\end{proof}

\begin{definition}
        Пусть $G \subset \R^n$ — непустое открытое множество, $x^0 \in G, \ l \in \R^n$. Пусть $f$: $G \mapsto \R$. Будем говорить, что $f$ имеет производную по направлению $l$ в точке $x^0$, если $$\exists \lim_{t \to +0} \dfrac{f (x^0 + tl) - f(x^0)}{t} \in \R .$$
\end{definition}

\begin{theorem}
    (Второе необходимое условие дифференцируемости) Пусть $G \subset \R^0 $~---~непустое открытое множество. \\
    Если $f$ дифференцируема в точке $x^0 \in G$, то существует производная по любому направлению $\forall l \in \R^n \ \exists \ \dfrac{\partial f}{\partial l} (x^0)$ и, более того, $\dfrac{\partial f}{\partial l} (x^0) = \langle \textup{grad} f(x^0), l \rangle$.
\end{theorem}

\begin{proof}
    Поскольку $f$ дифференцируема в точке $x^0 \in G$,
    $$f(x) = f(x^0) + \langle \textup{grad} f(x^0), x - x^0 \rangle + o\left(\|x - x^0\|\right), \ x \to x^{0}.$$
    Подставим $x = x^0 + tl$,
    $$ f(x^0 + tl) - f(x^0) = \langle \textup{grad} f(x^0), tl \rangle + \varepsilon_{x^0}(tl) \|tl\|$$
    $$\dfrac{f (x^0 + tl) - f(x^0)}{t} = \langle \textup{grad} f(x^0), l \rangle + \varepsilon_{x^0}(tl) \|l\| $$
    $$\lim\limits_{t \to 0} \dfrac{f (x^0 + tl) - f(x^0)}{t} = \langle \textup{grad} f(x^0), l \rangle$$
    $$\Longleftrightarrow \exists \ \dfrac{\partial f}{\partial l} (x^0) = \langle \textup{grad} f(x^0), l \rangle .$$
\end{proof}

\begin{note}
    Из существования производной по любому направлению не следует дифференцируемость.
\end{note}

\begin{example} $\ $ 
%\textbf{\\ ЗДЕСЬ ДОЛЖНА БЫТЬ КАРТИНКА (поднятая парабола)}
\sidefig(8 cm)(7 cm)
{
\begin{flushleft}
    \normalsize
    \centering
    \begin{equation*}
    f(x, y) = 
    \begin{cases}
        \left[
        \begin{array}{l}
        0, \: y \neq x^2, \\
        y = x = 0,
        \end{array}
        \right\\
        1, \: y = x^2 \text{ и } (x, y) \neq (0, 0)
    \end{cases}
    \newline
\end{equation*}
$\newline$

\end{flushleft}
}

\input{Pictures/parabola2}

$\forall l \in \R^2 \ \exists \delta(l) $: $\forall t \in \big(0, \delta(l)\big)$, $tl$ не пересекает параболу без вершины
\begin{flushright}
    $\Longrightarrow \dfrac{\partial f}{\partial l} (0, 0) = 0 \text{~---~производная по направлению}$
\end{flushright}


Рассмотрим две последовательности Гейне в точке $(0, 0)$:

\begin{enumerate}

\item Последовательность $(x_k, y_k) = \left(\dfrac{1}{k}, \dfrac{1}{k^2}\right)$ полностью лежит на параболе.
$$\forall k \in \N \: f(x_k, y_k) = 1 \Longrightarrow f(x_k, y_k) \to 1, k \to \infty.$$

\item Последовательность $f\left(0, \dfrac{1}{k}\right)$ не пересекает параболу, значит $$f\left(0, \dfrac{1}{k}\right) \to 0, k \to \infty.$$

\end{enumerate}

Таким образом, $\nexists \lim\limits_{(x, y) \to (0, 0)} f(x, y)  \: \Longrightarrow \: f$ разрывна в точке $(0, 0) \: \Longrightarrow$ $f$ не является дифференцируемой в точке $(0, 0)$.\\

\end{example}

\begin{reminder}
    Сфера в $\R^n$ имеет размерность $n-1$. \\
$S_r^{n-1}(x^{0}) := (n-1)$мерная сфера радиуса $r$ с центром в точке $x^{0}$.
\end{reminder}

\begin{theorem}
(Второй геометрический смысл градиента) Пусть $G \mapsto \R^n$~---~непустое открытое множество, $f$ дифференцируема в точке $x^0 \in G$ и grad$f(x^0) \neq 0$.

Тогда $\exists \max\limits_{l \in S_1^{n-1}(0)} \dfrac{\partial f}{\partial l}$ и $\exists \min\limits_{l \in S_1^{n-1}(0)} \dfrac{\partial f}{\partial l}$. При этом максимум достигается на направлении 

$$l_{max} = \dfrac{\textup{grad}f(x^0)}{\|\textup{grad}f(x^0)\|},$$

а минимум достигается на направлении $$l_{min} = \dfrac{-\textup{grad}f(x^0)}{\|\textup{grad}f(x^0)\|}.$$
\end{theorem}

\begin{proof}
    Так как $f$ дифференцируема в точке $x^0$, то в силу второго необходимого условия дифференцируемости $$\forall l \in S_1^{n-1}(0) \ \exists \ \dfrac{\partial f}{\partial l} = \langle \textup{grad} f(x^0), l \rangle$$
    $$|\langle \textup{grad} f(x^0), l \rangle| \leq \|\textup{grad} f(x^0)\| \|l\|$$
    $$-1 \leq \left\langle \dfrac{\textup{grad}f(x^0)}{\|\textup{grad}f(x^0)\|}, l \right\rangle (\star) \leq 1.$$
    $$\text{Заметим, что } \left\| \dfrac{\textup{grad}f(x^0)}{\|\textup{grad}f(x^0)\|} \right\| = 1.$$
    $$(\star) \text{~---~скалярное произведение, значит } (\star) = 1\text{, если } l = \dfrac{\textup{grad}f(x^0)}{\|\textup{grad}f(x^0)\|}, (\star) = -1, если \dfrac{- \textup{grad}f(x^0)}{\|\textup{grad}f(x^0)\|}.$$
\end{proof}



\begin{definition}
    Пусть $f$: $G \mapsto \R$, где $G \subset \R^n$~---~открыто и непусто, $x^{0} \in G$. Зафиксируем $i \in \{1, \ldots, n\}$.
    
    \textit{Частной производной} функции $f$ по $i$-ой координате в точке $x^0$ называетcя
    $$\lim\limits_{x_i \to x_i^0} \dfrac{f(x_1^0, \ldots, x_{i-1}^0, \ x_i, \ x_{i+1}^0, \ldots x_n^0) - f(x_1^0, \ldots, x_{i-1}^0, \ x_i^0, \ x_{i+1}^0, \ldots x_n^0)}{x_i - x_i^0}$$
    и обозначается $\dfrac{\partial f}{\partial x} (x^0) \Longleftrightarrow \begin{cases}
        \phi_i(t) := f(x_1^0, \ldots, t, \ldots x_n^0), \\
        \dfrac{d\phi_i}{dt}(x_i^0).
    \end{cases}$
\end{definition}



